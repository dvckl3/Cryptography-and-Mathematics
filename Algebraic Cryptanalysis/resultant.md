

Trước khi có sự ra đời của Groebner Basis thì Polynomial Resultant là một công cụ khá mạnh được sử dụng thường xuyên trong các bài toán giải hệ phương trình đa thức. Ngoài ra trong một số trường hợp đặc biệt thì Polynomial Resultant chạy hiệu quả hơn Groebner Basis. Trong bài viết này mình sẽ giới thiệu qua công cụ trên cũng như cơ sở lý thuyết của nó.

Đầu tiên mọi người có thể xem qua bài viết trước đó của mình về [Groebner Basis](https://hackmd.io/@dvck13/Bkb5cGAIkx). Trong bài mình có định nghĩa cụ thể các khái niệm về đa thức trên các vành giao hoán cũng như cách định nghĩa các đa thức nhiều biến. 


(vì không biết dịch resultant như thế nào cho hợp lý nên mình sẽ để nguyên như vậy trong bài luôn)

# Tóm tắt
## Trường hợp đơn biến 

Resultant của hai đa thức $\displaystyle f( x)$ và $\displaystyle g( x)$ là một giá trị mà nó sẽ triệt tiêu, tức là bằng 0 nếu như $\displaystyle f,g$ có nghiệm chung trong trường đóng đại số của trường mà ta đang nói tới. Để tính resultant của hai đa thức $\displaystyle f$ có bậc $\displaystyle d_{1}$ và $\displaystyle g$ có bậc $\displaystyle d_{2}$ thì ta sẽ viết các hệ số của hai đa thức dưới dạng ma trận Slyvester. https://en.wikipedia.org/wiki/Sylvester\_matrix

Cụ thể như sau: 

$$\begin{equation*}
\begin{aligned}
 & \{res}\left( a_{d_{1}} x^{d_{1}} +a_{d_{1} -1} x^{d_{1} -1} +\cdots +a_{1} x+a_{0} ,b_{d_{2}} x^{d_{2}} +b_{d_{2} -1} x^{d_{2} -1} +\cdots +b_{1} x+b_{0}\right) =\\
 & =\left[\begin{array}{ c c c c c c c c c c c c }
a_{d_{1}} & a_{d_{1} -1} & a_{d_{1} -2} & \cdots  & a_{1} & a_{0} & 0 & 0 & 0 & \cdots  & 0 & 0\\
0 & a_{d_{1}} & a_{d_{1} -1} & \cdots  & a_{2} & a_{1} & a_{0} & 0 & 0 & \cdots  & 0 & 0\\
0 & 0 & a_{d_{1}} & \cdots  & a_{3} & a_{2} & a_{1} & a_{0} & 0 & \cdots  & 0 & 0\\
\vdots  & \vdots  & \vdots  & \ddots  & \vdots  & \vdots  & \vdots  & \vdots  & \vdots  & \ddots  & \vdots  & \vdots \\
0 & 0 & 0 & \cdots  & 0 & 0 & 0 & a_{d_{1}} & a_{d_{1} -1} & \cdots  & a_{1} & a_{0}\\
b_{d_{2}} & b_{d_{2} -1} & b_{d_{2} -2} & \cdots  & b_{1} & b_{0} & 0 & 0 & 0 & \cdots  & 0 & 0\\
0 & b_{d_{1}} & b_{d_{2} -1} & \cdots  & b_{2} & b_{1} & b_{0} & 0 & 0 & \cdots  & 0 & 0\\
0 & 0 & b_{d_{2}} & \cdots  & b_{3} & b_{2} & b_{1} & b_{0} & 0 & \cdots  & 0 & 0\\
\vdots  & \vdots  & \vdots  & \ddots  & \vdots  & \vdots  & \vdots  & \vdots  & \vdots  & \ddots  & \vdots  & \vdots \\
0 & 0 & 0 & \cdots  & 0 & 0 & 0 & b_{d_{2}} & b_{d_{2} -1} & \cdots  & b_{1} & b_{0}
\end{array}\right]
\end{aligned}
\end{equation*}$$

## Trường hợp hai biến


Giả sử ta có hai đa thức $\displaystyle f( x,y) =x^{2} +y^{2} -1$ và $\displaystyle g( x,y) =x^{3} -x-y$. Để tìm nghiệm chung của hai đa thức thì ta có ý tưởng như sau: Ta viết lại các đa thức $\displaystyle f,g$ theo biến $\displaystyle y$ với các hệ số thuộc $\displaystyle \mathbb{Q}[ x]$, $\displaystyle \mathbb{Q}[ x]$ ở đây là tập các hàm đa thức theo biến $\displaystyle x$ với các hệ số hữu tỉ. Như vậy $\displaystyle f( y) =y^{2} +\left( x^{2} -1\right)$ và $\displaystyle g( y) =-y+x^{3} -x$. Khi đó Resultant của hai đa thức này sẽ là

$$\begin{equation*}
\begin{aligned}
\{det}\left[\begin{array}{ c c c }
1 & 0 & \left( x^{2} -1\right)\\
-1 & \left( x^{3} -x\right) & 0\\
0 & -1 & \left( x^{3} -x\right)
\end{array}\right] & =(1)\{det}\left[\begin{array}{ c c }
\left( x^{3} -x\right) & 0\\
-1 & \left( x^{3} -x\right)
\end{array}\right] +0+\left( x^{2} -1\right)\{det}\left[\begin{array}{ c c }
-1 & \left( x^{3} -x\right)\\
0 & -1
\end{array}\right]\\
 & =\left( x^{3} -x\right)^{2} +\left( x^{2} -1\right)\left( 1-x^{3} +x\right)\\
 & =x^{6} -x^{5} -2x^{4} +2x^{3} +2x^{2} -x-1\\
 & =(x-1)(x+1)\left( x^{4} -x^{3} -x^{2} +x+1\right)
\end{aligned}
\end{equation*}$$

Ta có được $\displaystyle x=1$ và $\displaystyle x=-1$ là nghiệm của đa thức trên và thay lại vào $\displaystyle f( x,y)$ để tìm $\displaystyle y$. 


## Ví dụ
### Chall 1: KCSC Recruitment 2025
Source code:
```python
from Crypto.Util.number import *
from math import gcd

flag = b"KCSC{fake_flag}"

p = getPrime(512)
q = getPrime(512)
n = p*q
e = 0x10001
c = pow(bytes_to_long(flag), e, n)

print(f"n = {n}")
print(f"c = {c}")
print(13 * q ** 2 + 5*p * q + 2 * p ** 5)
print(7 * q ** 3 + p ** 3)

"""
n = 68288521803749096598885637638053621717196600162883393314204537792265324550130476000830582459892601191221713398147068471895218340440441520348186049243098557276069294337290348570168822004443403024217772173472817801983123070596861372926544266786307347422625999741472764054251261966242723803223755250857431959613
c = 51484360656675894405169578577777421818221080188874188339332704212766014455602299232733441854614491353614936672698767100621643701474052897096397257567627546370308824123953740553988694850896612092526733722171750215446879926157508653359056454370778767748861899945472045315573513667461778478951641271690253340703
99070322718633589075437462797565157261778565342202176866775343970398558639214129862647491552411934954337080928975984888590350647667063750589996693551004764949048370796506334502440334616612079528441181921243264137829513725003752633040825654275249100544290948338516838946174770287568358642193272862193796894044937197882972942736350187023160283258646203934697126833099845086570117310993425665455046278368788256843647321433937611726466080931200057154600456738627871172358125025243308598393199170155505096434440339433895197600955266878886512068835988415711337072167542113641557473147599428014808952558696371214362762804029219711275834667722478355607836912560341298862576500518929722837267759516608623300378294362866958920710706131156072317563285732965572961520111862487408104
4053829493753080394597319030520465552249075460276768487813206903952134102796024072650537404512981555893331018255239607908419904554570951529767887735220350920134963507895001907309725345634404748146887358629605419756823088475689769294303699918630919892363333011358649952996211367887394670736389996674537151867058156643368735877078538193576703224594833465330136899282032495128158051461158831558808541670885217172490157676355847572589184884710346372276161554121356404
 """
```
Đọc sơ qua source thì ta biết ngay bài này sẽ xài Resultant bằng cách dựng hệ phương trình 2 đa thức $\displaystyle f( p,q) =13q^{2} +5pq+2p^{5} -c_{1}$ và $\displaystyle g( p,q) =7q^{3} +p^{3} -c_{2}$ có nghiệm là cặp $\displaystyle ( p,q)$

Code giải:
```python
import sage.all as sage
from Cryptodome.Util.number import long_to_bytes, inverse
n = 68288521803749096598885637638053621717196600162883393314204537792265324550130476000830582459892601191221713398147068471895218340440441520348186049243098557276069294337290348570168822004443403024217772173472817801983123070596861372926544266786307347422625999741472764054251261966242723803223755250857431959613
c = 51484360656675894405169578577777421818221080188874188339332704212766014455602299232733441854614491353614936672698767100621643701474052897096397257567627546370308824123953740553988694850896612092526733722171750215446879926157508653359056454370778767748861899945472045315573513667461778478951641271690253340703
c1 = 99070322718633589075437462797565157261778565342202176866775343970398558639214129862647491552411934954337080928975984888590350647667063750589996693551004764949048370796506334502440334616612079528441181921243264137829513725003752633040825654275249100544290948338516838946174770287568358642193272862193796894044937197882972942736350187023160283258646203934697126833099845086570117310993425665455046278368788256843647321433937611726466080931200057154600456738627871172358125025243308598393199170155505096434440339433895197600955266878886512068835988415711337072167542113641557473147599428014808952558696371214362762804029219711275834667722478355607836912560341298862576500518929722837267759516608623300378294362866958920710706131156072317563285732965572961520111862487408104
c2 = 4053829493753080394597319030520465552249075460276768487813206903952134102796024072650537404512981555893331018255239607908419904554570951529767887735220350920134963507895001907309725345634404748146887358629605419756823088475689769294303699918630919892363333011358649952996211367887394670736389996674537151867058156643368735877078538193576703224594833465330136899282032495128158051461158831558808541670885217172490157676355847572589184884710346372276161554121356404
e = 0x10001  
P = sage.PolynomialRing(sage.ZZ, ['p', 'q'])
p, q = P.gens()
f = 13 * q**2 + 5 * p * q + 2 * p**5 - c1
g = 7 * q**3 + p**3 - c2
res = f.resultant(g, q)
P_p = sage.PolynomialRing(sage.ZZ, 'p')
res_univariate = P_p(res)
p_val = res_univariate.roots(multiplicities=False)[0]  
P_q = sage.PolynomialRing(sage.ZZ, 'q')
g_univariate = P_q(g(p=p_val))
q_val = g_univariate.roots(multiplicities=False)[0]
assert p_val * q_val == n
phi = (p_val - 1) * (q_val - 1)
d = inverse(e, phi)
m = pow(c, int(d), n)
flag = long_to_bytes(m)
print(flag.decode())
```
`KCSC{solv1ng_equ4ti0ns_with_r3sult4nts_is_f4n}`


### Chall 2: equations - Grey Cat The Flag 2022

Source code:
```python
from Crypto.Util.number import bytes_to_long 
FLAG = <REDACTED> 
n = len(FLAG)
m1 = bytes_to_long(FLAG[:n//2])
m2 = bytes_to_long(FLAG[n//2:]) 
print(13 * m2 ** 2 + m1 * m2 + 5 * m1 ** 7)
print(7 * m2 ** 3 + m1 ** 5) 


# 13 * m2 ** 2 + m1 * m2 + 5 * m1 ** 7 == 6561821624691895712873377320063570390939946639950635657527777521426768466359662578427758969698096016398495828220393137128357364447572051249538433588995498109880402036738005670285022506692856341252251274655224436746803335217986355992318039808507702082316654369455481303417210113572142828110728548334885189082445291316883426955606971188107523623884530298462454231862166009036435034774889739219596825015869438262395817426235839741851623674273735589636463917543863676226839118150365571855933
# 7 * m2 ** 3 + m1 ** 5 == 168725889275386139859700168943249101327257707329805276301218500736697949839905039567802183739628415354469703740912207864678244970740311284556651190183619972501596417428866492657881943832362353527907371181900970981198570814739390259973631366272137756472209930619950549930165174231791691947733834860756308354192163106517240627845889335379340460495043
```

Code giải(sage): 
```sage
from Cryptodome.Util.number import long_to_bytes

R.<m1, m2> = ZZ[]

f = (13 * m2 ** 2 + m1 * m2 + 5 * m1 ** 7) - 6561821624691895712873377320063570390939946639950635657527777521426768466359662578427758969698096016398495828220393137128357364447572051249538433588995498109880402036738005670285022506692856341252251274655224436746803335217986355992318039808507702082316654369455481303417210113572142828110728548334885189082445291316883426955606971188107523623884530298462454231862166009036435034774889739219596825015869438262395817426235839741851623674273735589636463917543863676226839118150365571855933
g = (7 * m2 ** 3 + m1 ** 5) - 168725889275386139859700168943249101327257707329805276301218500736697949839905039567802183739628415354469703740912207864678244970740311284556651190183619972501596417428866492657881943832362353527907371181900970981198570814739390259973631366272137756472209930619950549930165174231791691947733834860756308354192163106517240627845889335379340460495043

part1 = f.resultant(g, m2).univariate_polynomial().roots()[0][0]
part2 = f.resultant(g, m1).univariate_polynomial().roots()[0][0]

print(long_to_bytes(int(part1)).decode() + long_to_bytes(int(part2)).decode())
```
# Cơ sở toán học
... (still research)

# Tài liệu tham khảo 
[1] http://buzzard.ups.edu/courses/2016spring/projects/woody-resultants-ups-434-2016.pdf


## Sample code:
1. https://github.com/sympy/sympy/blob/master/sympy/polys/multivariate_resultants.py

